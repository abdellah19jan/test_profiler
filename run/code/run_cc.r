# Databricks notebook source
#===============================================================================#
#    I - Charger le fichier main.R                                              #
#===============================================================================#

source("code/main.R", encoding = "UTF-8")

#===============================================================================#
#   II - Stocker le carnet de commande dans un fichier RDS                      #
#===============================================================================#

write_cc()

#===============================================================================#
#  III - Fonction principale                                                    #
#===============================================================================#

run_carnet_commande()

#===============================================================================#
#   IV - Concaténer les résultats de simulation du carnet de commande           #
#===============================================================================#

result <- bind_cc()


#===============================================================================#
#    V - Stocker les prédictions dans un fichier CSV                            #
#===============================================================================#

write_pred_cc(result)



#===============================================================================#
#   VI - Calculer les CAR par type d'offre, type de prix & formule d'indexation #
#===============================================================================#

load_car()
